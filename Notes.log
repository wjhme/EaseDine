部分语音是多通道:
A_audio/72a4013c-0141-4350-a6cb-28577a0977cd.wav  2 取第一个通道
train_audio/train_audio_batch_6/b0d2bde3-4aaa-4be1-8709-420a56f1d3dc.wav 5 前三个通道均可
train_audio/train_audio_batch_6/afadff3f-4e28-4029-a679-592b980f4842.wav 2 两个通道均可


A榜测试:
识别不准确的音频:
0e7f1d8b-2786-4bfb-8579-7173f692dfdb	天猫精灵要个鹿茸净小草吧
8de1c21b-e5f5-471f-ab47-8e0115a97497	快一点给我们姐姐给我放大声一点
9a477a8f-efb2-4911-bdef-2599f5e2b240	天猫精灵基数是双数还是单数
51c55580-0b6b-4e21-a7c1-f454f49467b4	天猫精灵 EAT来碗热乎的山药排骨粥吧 (EAT 是打嗝声)
c7563fb8-7d43-41a4-abc0-07847b061637	天猫精灵 LEVEL红枣核桃养胃粥吧 (LEVEL->来碗)
28846702-87cd-48eb-bbbc-78012ec4d1b0	单臂 LYING自己胸椎的锻炼方式有哪些 (听不清)

部分识别错误的词可以通过映射还原:
c1d316ca-9cf2-4288-9a2e-4797a6220222	天猫精灵要往三月红枣粥养胃的    (要往)  要碗
4a97d4b5-1cc9-4afc-8ea8-82c7ee78044a	天猫精灵来问桂圆山药粥养养胃    (来问)  来碗
63330015-cf56-4f3f-90ca-950d322497b5	天猫精灵来玩儿鱼丸儿粉丝汤吧    (来玩)
fb02b2ae-b8bc-49db-ae67-02d801b4894a	天猫精灵要玩香菇鸡用热粥热乎的  (要玩)
9ac0b285-7bdf-496a-ae5a-e364082276df	天猫精灵来问摩羯座小草吧        (来问|小草) 小炒
2952b118-3d7e-44c0-b5f3-8801b5ffbe6a	天猫精灵来问外婆家的那些小草吧  (来问|小草)
4e8ac044-a824-4fbc-9a64-1be3f421f883	芹菜香根小草来一份吧
1222ff32-7ae2-4627-a65a-dfdd1cb1d953	天猫精灵要个加长小草黑木耳吧
f0467100-9996-40c7-a26d-3a17ed0c3b0c	天猫精灵灵魂高帮的四小草吧
72911330-ad68-433a-af7d-6a38c3c7ad02	天猫精灵雷夫杜绝如此小草
5237b5dd-467d-4cb5-8981-8b883506d3de	来玩    （有噪音识别干扰，实际语音:来碗XXX）
c5289a11-bfbf-4545-bfc6-aec9dd3bb9d6	天猫精灵我要玩脑筋急转弯游戏    （误判）
养身粥 -》养生粥

识别的更准确:
train_audio_batch_1
                                                    识别                                    真实内容
09486fbe-37ef-41ab-a105-3689fb0e9ee6       大一点点天猫精灵声音再调大一点点  0.12    天猫精灵声音再调大一点点大一点点

======================== 识别不出或不准的语音 ============================
FunASR :
                                      uuid pred_text  time      text
1079  0643c10e-8aeb-4ea0-8c16-e1ada2f9749b       NaN  0.13  天猫精灵，来碗桂圆银耳甜粥吧
2438  0d3f13f7-4de5-4239-8af0-da51cda186a1       NaN  0.06  山药搭芥兰木耳小炒来一份伐，清爽点哦，盐头么少摆眼，吾年纪大了吃伐得忒咸，麻烦侬哉！
2975  1407451f-98ff-4f7b-96da-5bae4374dece       NaN  0.06  天猫精灵，要份萝卜排骨汤，热乎的。
4381  00539765-2f08-4a5e-941d-e403e99cc757       NaN  0.08  天猫精灵播放声音放大大一点声音
4791  0ccb7b19-0f6a-462b-88fc-8e3b11fa4923       NaN  0.08  搿碗鲜得来眉毛落特额干贝虾仁粥帮吾来一份呀，粥要烧得糊哒哒额，伐该哦！
5874  0e58d57d-c7d4-4e6b-a086-28f168b5f700       NaN  0.09  天猫精灵，来碗暖心南瓜甜粥吧
      164c3778-2a7d-4660-ba8e-00a19329aa89	耶
FireRedASR:
63b3417c-29c4-48e5-87cf-dec535fee007	你好我是克勤	

================== 语音识别评估 测试数据集:train_audio_batch_1 大小:9815 ========================
【FunASR】
【batch_1】
ASR得分         所用模型或方法                            用时                                零字错率
0.8420      (取第一个通道)                       
0.8488      (平均池化)                            识别用时:800 s          
0.9469      (batch_2微调模型,平均池化)            平均用时:0.06.                                            cer==0:6737/9815       无字母      
0.9470      (batch_2微调模型,平均池化)            平均用时:0.06,总耗时:612.28.                              cer==0:6727/9815       保留字母    
0.9399      (large 微调,平均池化)                 平均用时:0.06,总耗时:613.51.                              cer==0:6826/9815       保留字母    
0.9531      (batch_2345_6微调)                    平均用时:0.06,总耗时:767.52.                              cer==0:6987/9815       保留字母    
0.9531      (batch_234567_89微调)                 总耗时:767.52.                                            cer==0:7040/9815       保留字母    
0.9520      (batch_234567_89微调基础上，用增强数据集(cer_0)微调,取平均模型)                                       cer==0:7078/9815
0.9601      (batch_234567_89微调基础上，用增强数据集(cer_0 + cer_over_0)微调,最佳模型:batch_enhence_model)     cer==0:7370/9815
0.9560      (mabin 二次训练)                                                                                cer==0:7221/9815
0.9612      (mabin 二次训练 + cer_over_0 数据增强)                                                          cer==0:7371/9815
            (finetuner_my_enhanced <- batch_234567_89 + 增强cer_over_0)
0.9512      (筛选cer小于0.3的数据集进行微调)
0.9475      (筛选cer小于0.1的数据集进行微调)
0.9543      (batch_1_finetuner_model_234567_89_cer_06)
0.9550      (batch_1_finetuner_model_batch_enhence_model_001_1)
0.9775      (batch_1_enhence_model_189_train_val, best)                                                       cer==0:8400/9815    
0.9771      (batch_1_enhence_model_189_train_val, avg)                                                      cer==0:8384/9815 
0.9607      (batch_1_enhence_model_allbatch_0_1_best)
0.9879      (189_mode_raw_enhanced_epcho_43,多次微调,最后原始训练集和增强数据集同时进行微调,beam_size=10)          cer==0:8987/9815 
0.9883      (189_mode_raw_enhanced_epcho_48,多次微调,最后原始训练集和增强数据集同时进行微调,beam_size=10)          cer==0:9039/9815 
0.9892      (189_mode_raw_enhanced_epcho_60,多次微调,最后原始训练集和增强数据集同时进行微调,beam_size=10)          cer==0:9099/9815 


【方言数据】
ASR得分           所用模型或方法
0.7726      (预训练模型,平均池化)               平均用时:0.06.                                  cer==0:5272/14910
0.9655      (batch_2微调模型,平均池化)          平均用时:0.06.                                  cer==0:11460/14910
0.9319      (large 微调模型,平均池化)           平均用时:0.06,总耗时:1025.48.                   cer==0:11074/14910
0.9744      (batch_2345_6微调,平均池化)         mean time:0.06,total time:1070.73.              cer==0:12032/14910
0.9759      (batch_234567_89微调,平均池化)      mean time:0.06,total time:942.79.               cer==0:12032/14910
0.9696      (batch_234567_89微调基础上，用增强数据集(cer_0)微调,取平均模型)                        cer==0:12004/14910
0.9792      (batch_234567_89微调基础上，用增强数据集(cer_0 + cer_over_0)微调,最佳模型)             cer==0:12454/14910
0.9935      (mabin 二次训练)                                                                    cer==0:13956/14910
0.9860      (mabin 二次训练 + cer_over_0 数据增强)                                              cer==0:12900/14910
0.9817      (fangyan_finetuner_best_model_189_train_val)                                       cer==0:12659/14910



【FireRedASR】
FireRedASR train_audio_batch_1 ASR得分:0.8571     识别用时:3000 s
FireRedASR train_audio_batch_1_beam_size_5 ASR得分:0.8588     识别用时:92.42 min
================================================================================================



DOM:
基于关键词判断:
# 点餐关键词列表
pos_keywords = ['来碗', '来份', '要碗', '来一份', '要份', "要个", "养胃", "热乎"]

我要唱吕可可的来一份失恋 0

# 非点餐关键词列表
neg_keywords = ['播放', '等于', '声音', '音量', '乘以', "多少", "音乐", "除以", "歌曲", "打开", "唱"]

train.txt 77841
pos_keywords 32541  dom == 1
neg_keywords 19593  dom == 0
覆盖66.97%

A_audio.txt 4000
pos_keywords 1510  dom == 1
neg_keywords 893  dom == 0
覆盖60.08%

================================= A_audio 模型预测和关键词判断不同的数据 =================================================
                                   text                             dom      dom_key        keyword 误判
429                       天猫精灵来碗儿邂逅不起走吧                    0         1
581           哎帮我来一份老上海女性做菜汤好吧你回复我吃吃老十一           0        1
623                          天猫精灵要个不用你的                       0        1
828           天猫精灵帮我来一份奥利香米的汤好吧汤里香都把底料做           0        1
1080                       我要唱吕可可的来一份失恋                      0        1                 *
1581                         播放番茄炒牛腩的菜谱                        1        0
1597  天猫精灵帮我来一份宵夜把养生粥烧的熟掉我要糖糖一起读了下课五点睡了     0        1
1634                       我要唱吕可可的来一份失恋                       0        1                *
2127                  提莫今天来碗谁要八国联军做吧你活该                   0        1
2776             帮我来一份营养美味的包子好吧介绍一下这家口味               0        1
2794                 天猫精灵来碗儿闪耀以谜杨为咒吧样样伪                  0        1
2853                    啊天猫精灵一起来碗脑筋急转弯吧                     0        1                *
3265                        要份的茶是属于土鸡汤的                        0        1
3349                        来为我们做小米养胃做吧                        0        1
3569                         让我宁儿给吃养胃作吧                         0        1
3643     天猫精灵你好帮我来一份老灵光啊找吧欢迎你找你到第二个呀我给啊         0        1
3652                    天猫精灵来为你喝养胃的黑米酒吧                     0        1


分类错误:
天猫精灵适合老年人的	0
天猫精灵不要辣不要油腻	0
不要油炸的	0
海带鸡肉汤需要提前腌制吗	1


====================================== train_audio_batch 数据集信息 ====================================================
['train_audio_batch_1', 'train_audio_batch_3', 'train_audio_batch_7', 'train_audio_batch_8', 'train_audio_batch_2', 'train_audio_batch_4', 'train_audio_batch_9', 'train_audio_batch_6', 'train_audio_batch_5']


                        音频数量    cer=0(FireRedASR预训练模型)   cer=0(FunASR 增强微调)
train_audio_batch_1       9814      4692                          7372 0.9601
train_audio_batch_2       9690      4566                          7724 0.9691
train_audio_batch_3       9749      4615                          7724 0.9689
train_audio_batch_4       9743      4637                          7728 0.9682
train_audio_batch_5       9635      4548                          7602 0.9666
train_audio_batch_6       9712      4651                          7682 0.9679
train_audio_batch_7       9720      4452                          7684 0.9663
train_audio_batch_8       9744      4671                          7384 0.9618
train_audio_batch_9       24        9                             19   0.9820
共计:77831
cer_0 size:                         36844                         60886
cer_over_0 size:                    40997                         16955


====================================================================================================






================================= 歌曲名称或歌手识别错误 A_audio =====================================
0a0c93c1-2b5c-42dc-aefa-6e238aad5051	我想听冉妍霏的是我太愚笨            阮妍霏 是我太愚笨
573c6a93-6a87-447f-a13b-b1fcccb96e1e	我想听六崽哥的山鬼喝不了道士的酒    六仔哥 山鬼喝不了道士的酒
80204fb1-9a86-4b20-8064-86878e848054	我想听艺玲的错爱的惩罚              艺凌 错爱的惩罚
353c779f-d6de-4739-86e0-0c170d13de30	天猫精灵播放我把来生许有的你              我把来生许给了你
0612d9d1-950e-4c8d-9c72-ac4a02f3481d	我想听王熙的午后三点                王晰 午后三点
d9b70c2c-ae06-4ff0-82e8-677a6cc5fc83	我想听杨一然的遗悍接在风中          杨伊然 遗憾皆在风中
8e428ec7-eb85-43c0-962d-8e62fe463d51	我想听安尔陈的烟酒不及情伤人        安儿陈 烟酒不及情伤人
cca2dc7b-f37a-4a8b-8612-dd763153514a	我想听周深的歌且行且开心            周深 且行且开埙
8c98447d-8e68-46aa-aee6-4af98d76e1fe	我想听夏晚安的不爱呀不出心动        夏婉安 不爱演不出心动
960c69d3-be0e-4f2a-a3ce-df04678ebeac	我想听自动挡吉他手的爱海涛涛        自动挡吉他手 爱海滔滔
dc4a3fd4-d349-48d2-ba81-d61f795c95d2	我想听傲肆的不甜情歌               阿肆 不甜情歌   
30990015-cf8c-476e-98bc-c069d7df0d61	我想听任鹏鹏的四处旁煌             任鹏鹏  四处彷徨

====================================================================================================







=========================================== 提交记录 ================================================

A_audio_recognition_dom_4_14              小红书模型识别（调参:beam_size=5）,完善词映射,完善关键词判断
Results_4_15_FunASR_finetuner_small       阿里模型识别（基于batch_2进行微调）
Results_4_16_FunASR_finetuner_small_en    阿里模型识别（基于batch_2进行微调）保存英文输出         0.9501
Results_4_17_part1_score                  第一部分得分 0.4760 --> 95.20%
Results_4_18_part2_score                  第二部分得分 0.2974 --> 99.13%
                                          第三部分得分 0.1767 --> 88.35%
Results_4_19_FunASR_finetuner_24567_89    阿里模型(batch_24567训练集,batch_89验证集)            0.9531
Results_4_20                              第一部分得分 0.4786 --> 95.72% (二阶微调)
Results_4_21                              阿里模型(方言微调后，进行二次微调)                     0.9537
Results_4_22_菜品库清洗                    阿里模型(方言微调后，进行二次微调) 菜品库清洗
Results_4_26                              阿里模型(mabin模型基础上 用cer>0的增强数据集微调)前两部分结果     0.7749
Results_4_27                              阿里模型(4_19模型基础上 用增强数据集微调)前两部分结果      0.7787 
Results_4_28                              阿里模型(4_19模型基础上 用增强数据集微调)完整结果           0.9566
Results_4_29                              阿里模型(4_19模型基础上 使用cer<0.6的增强数据集训练)        0.7770
Results_5_5_189_train_val_avg             阿里模型(4_19模型基础上 使用batch_189训练)                  0.7792
Results_5_7_allbatch_0_1_best             阿里模型(4_19模型基础上 使用cer在0-1的数据训练,best)         0.7791
Results_5_9_189_train_val_avg_llm_process_new     大模型纠正                                          0.7803
==========================================================================================================


2025.04.20 会议:

ASR

文档内容:训练时长、使用模型等
1、菜品列表中:加个小白菜  这种是菜品吗，需要处理为小白菜吗
2、文档是在复赛阶段需要提交吗
3、系统整体响应时间如何评估？
4、B榜数据集和A榜有哪些区别？
B榜更复杂、更加真实场景
5、模型加载时间应该不会算时间。
6、历史信息:






"""
识别用户输入文本,返回满足要求的JSON。
JSON必须包含两个字段: 'Error_judge' 和 'Text_corrected'。
'Error_judge': 布尔类型(boolean)，表示用户输入文本是否存在错误，需要根据常识或者歌曲名、歌手名、菜品名称是否存在错字或同音字错误进行判断 (true or false)。
'Text_corrected': 字符串类型(string)，表示对存在错误的用户输入文本进行纠正后的文本。
如果输入文本没有错误，则返回空字符串 ""。
严格按照JSON格式输出，不要包含任何额外的解释或标记。
例如输入:我想听杨一然的遗悍接在风中
输出:{{  "Error_judge": true,  "Text_corrected": "我想听杨伊然的遗憾皆在风中"}}
例如输入:天猫精灵放打火鸡的声音
输出:{{  "Error_judge": true,  "Text_corrected": "天猫精灵放打火机的声音"}}
例如输入:给我来份紫菜蛋花汤吧
输出:{{  "Error_judge": false,  "Text_corrected": ""}}
当前用户输入:{user_input}
"""









# =========================  开源数据集 ========================================
魔塔社区:
数据堂205人噪音环境口音普通话手机采集语音数据 https://www.modelscope.cn/datasets/DatatangBeijing/205People_MandarinSpeechDatainNoisyEnvironmentByMobilePhone/summary
数据堂—245小时车载环境普通话手机采集语音数据 https://www.modelscope.cn/datasets/DatatangBeijing/245Hours_MandarinSpeechDatainCarsByMobilePhone/dataPeview
数据堂—1,505小时普通话手机采集语音数据 https://www.modelscope.cn/datasets/DatatangBeijing/1505Hours-MandarinSpeechbyMobilePhone/dataPeview
数据堂—1,030小时上海方言手机采集语音数据 https://www.modelscope.cn/datasets/DatatangBeijing/1030Hours-ShanghaiDialectSpeechDataByMobilePhone




# =========================  模糊语义（注意有些既有菜品又有模糊语义） ========================================
少油少盐的/少盐少油的
少盐少糖的
少盐的
少盐少辣的
少油少酱的
清淡少盐的
清淡不腻的
不腻的
不油腻的
顺口的
（容）易嚼的
不太咸的
别太咸的



======================================== 训练数据集 ================================================================
4.28 /mnt/disk/wjh23/EaseDine/ASR/FunASR/FunASR_all_batch_results/train_val_03.scp  大小：66410 选择cer <= 0.3 的数据